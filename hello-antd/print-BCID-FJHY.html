<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="UTF-8">
  <title>福建华源建材有限公司过磅单</title>
  <style type="text/css">
    body {
      font-family: "宋体", "simsun", "微软雅黑", "Arial Unicode MS", "Arial Narrow", HELVETICA !important;
    }

    pre {
      text-align: left;
      font-family: "微软雅黑", "simsun", "宋体", "Arial Unicode MS", "Arial Narrow", HELVETICA !important;
      /*忽略空白*/
      white-space: normal;
      margin: 0;
      padding: 5px 5px;
    }

    table {
      width: 100%;
      margin-bottom: 10px;
      font-size: 12pt;
      font-weight: bold;
      background-color: transparent;
      /*边框合并成一线*/
      border-collapse: collapse;

      border-spacing: 0;
    }

    table td {
      padding-left: 5px;
      line-height: 4em;
      border: 1px solid #000000;
    }

    span {
      font-weight: bold;
      text-align: left;
    }

    .rows {
      width: 860px;
      margin: 0 auto;
      word-wrap: break-word;
      font-size: 19px;
    }

    .rows h3 {
      font-size: 1.8em;
      -webkit-margin-before: 0em;
      -webkit-margin-after: 0.7em;
    }

    .center {
      text-align: center !important;
    }

    .rows label {
      font-weight: bold;
      font-size: 11px;
    }



  </style>
  <script src="../js/jquery.min.js"></script>
  <script src="js/xmprint.js"></script>
</head>

<body class="rows">
  <div class="center head">
    <h3>福建华源建材有限公司</h3>
    <h3><span style="border-bottom: 1px solid">过磅单</span></h3>

  <table class="rows" style="margin-bottom:3px;">
    <tbody>
    <tr>
      <td  style="width:10em;border:none;line-height: 1em;text-align: left;">供货单位：</td>
      <td  style="width:10em;border:none;line-height: 1em;"><span class="record" data-name=""> </span> </td>
      <td  style="width:10em;border:none;line-height: 1em;padding-left: 15%;">日期：</td>
      <td  style="width:10em;border:none;line-height: 1em;"><span class="record" data-name=""  data-type="date" data-flag="yyyy-MM-dd"> </span> </td>
    </tr>
    </tbody>
  </table>
  <div style="height: 20px;margin-right: -3%;float: right;width: 20px;font-size: 19px;margin-top: 10%;">
   第一联&nbsp;存根联
  </div>
  <table class="rows">
    <tbody style="text-align: center">
    <tr>
      <td style="width:7em;">货品类别</td>
      <td style="width:7em;height:4em;"><span class="record" data-name="">  </span></td>
      <td style="width:6em">车牌号码</td>
      <td style="width:6em;height:4em;"><span class="record" data-name=""> </span></td>
    </tr>

    <tr>
      <td rowspan="2" style="width:7em;">过磅记录</td>
      <td  style="width:7em;">毛重(吨)</td>
      <td  style="width:7em;">皮重(吨)</td>
      <td  style="width:7em;">净重(吨)</td>
    </tr>

    <tr>
      <td style="width:7em;height:4em;"><span class="record" data-name="">  </span></td>
      <td style="width:6em;height:4em;"><span class="record" data-name=""> </span></td>
      <td style="width:6em;height:4em;"><span class="record" data-name=""> </span></td>
    </tr>

    <tr>
      <td  style="width:7em;">毛重过磅记录</td>
      <td  style="width:7em;height:4em;">
        <span class="record" data-name=""  data-type="date" data-flag="yyyy-MM-dd">  </span>
        <span class="record" data-name=""  data-type="time" data-flag="hh-mm-ss">  </span>
      </td>
      <td style="width:6em">皮重过磅记录</td>
      <td style="width:6em;height:4em;">
        <span class="record" data-name=""  data-type="date" data-flag="yyyy-MM-dd">  </span>
        <span class="record" data-name=""  data-type="time" data-flag="hh-mm-ss">  </span>
      </td>
    </tr>

    <tr>
      <td style="width:7em;">备注</td>
      <td colspan="3" style="width:7em;height:3em;"><span class="record" data-name="">  </span></td>
    </tr>

    <tr>
      <td style="width:7em;border:none;"><span style="float:right;">驾驶员：</span></td>
      <td style="width:7em;height:3em;border:none;"><span class="record" data-name="">  </span></td>
      <td style="width:7em;border:none;"><span style="float:right;">过磅员：</span></td>
      <td style="width:7em;height:3em;border:none;"><span class="record" data-name="">  </span></td>
    </tr>

    <tr>
      <td style="width:7em;border:none;"><span style="padding-right: 8%;float: right;">电话：</span></td>
      <td style="width:7em;height:3em;border:none;"><span style="float: left">0595-87791888</span></td>
      <td style="width:7em;border:none;"><span style="padding-right: 8%;float: right;">保真：</span></td>
      <td style="width:7em;height:3em;border:none;"><span style="float: left">0595-87976555</span></td>
    </tr>

    </tbody>
  </table>
</div>
</body>
</html>
<script src="http://localhost:18000/CLodopfuncs.js?priority=0"></script>
<script src="http://localhost:8000/CLodopfuncs.js?priority=1"></script>
<script src="js/LodopFuncs.js"></script>
<script src="js/xmprint.js"></script>
<script>
  $(function () {
    var fno = GetQueryString('fno');
    if (fno && fno != 0) {
      callSapiServer("/print/P_bcld", function (result) {
        console.log(result)
        if (!result.isException) {
          var record = result.data?result.data[0]:{};
          setTimeout(lodopPrint, 1000);
          function lodopPrint() {
            //调用 lodp打印控件
            var LODOP = getLodop();
            LODOP.PRINT_INITA("", "", 2400, 930, "")
            LODOP.SET_PRINT_PAGESIZE(1, 2400, 930, "")

            //发给测试的一定要注释掉！！！========================
            // 指定背景图
            LODOP.ADD_PRINT_SETUP_BKIMG("E:\\bbb.jpg");
            // 设置显示模式
            LODOP.SET_SHOW_MODE("BKIMG_LEFT",0);
            LODOP.SET_SHOW_MODE("BKIMG_TOP",0);
            LODOP.SET_SHOW_MODE("BKIMG_WIDTH","240mm");
            LODOP.SET_SHOW_MODE("BKIMG_HEIGHT","93mm");
            LODOP.SET_SHOW_MODE("BKIMG_PRINT",true);
//                      左上、左左、长、宽
//            =========================================
            //          供货单位
            LODOP.ADD_PRINT_TEXT(85, 537, 113, 20, record.);
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 11);
//            日期
            LODOP.ADD_PRINT_TEXT(106, 117, 131, 60, record.);
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
            //货品类别
            LODOP.ADD_PRINT_TEXT(106, 328, 131, 60, record.);
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
            //车牌号码
            LODOP.ADD_PRINT_TEXT(106, 539, 131, 60, record.);
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
            //毛重(吨)
            LODOP.ADD_PRINT_TEXT(186, 43, 80, 25, record.);
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 11);
            //皮重(吨)
            LODOP.ADD_PRINT_TEXT(186, 125, 65, 25, record.);
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 11);
            //净重(吨)
            LODOP.ADD_PRINT_TEXT(186, 211, 161, 24, record.);
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 11);
            //毛重过磅记录
            LODOP.ADD_PRINT_TEXT(186, 379, 131, 24, record.);
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 11);
            //皮重过磅记录
            LODOP.ADD_PRINT_TEXT(186, 553, 70, 24, record.);
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 11);
            //备注
            LODOP.ADD_PRINT_TEXT(258, 43, 81, 25, record.);
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 11);
            //驾驶员
            LODOP.ADD_PRINT_TEXT(258, 125, 85, 25, record.);
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 11);
            //过磅员
            LODOP.ADD_PRINT_TEXT(258, 211, 85, 25, record.);
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 11);
            //==================================
            LODOP.PRINT_SETUP();
            LODOP.PREVIEW();
          }
          $(".record").each(function () {
            var filedName = $(this).data("name");
            if (filedName && filedName != "") {
              var val = record[filedName];
              if(val != undefined && val.match(/^\d*\.\d{3}$/g) != null)
                val = parseFloat(val).toFixed(2);
              if($(this).data("type")==='date'&&val){
                val=val?dateToFormat(val,$(this).data("flag")):val
              }
              else if($(this).data("type")==='time'){
                val=val?dateToFormat(val,'hh:mm:ss'):val
              }
              $(this).text(val);
            }
          });
        }
      }, "POST", { fno: fno }, false)
    }
  })

</script>
